<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/contacto.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
    <title>Soluciones Daniel</title>
    <style>
        #map {
            height: 400px;
            width: 100%;
            border-radius: 8px;
        }

        #info {
            margin-top: 10px;
            font-family: Arial;
        }
    </style>
</head>

<body>
    <header class="header_section bg-dark">
        <div class="container-fluid">
            <div class="row align-items-center">
                <!-- Logo -->
                <div data-aos="flip-left" data-aos-duration="3000"
                    class="logo col-12 col-lg-3 text-center text-lg-start py-2">
                    <a href="index.html">
                        <img src="imagenes/logo2-SolucionesDaniel.png" alt="Logo Soluciones Daniel"
                            class="img-fluid col-6" style="max-height: 80px;">
                    </a>
                </div>

                <!-- Navbar -->
                <div class="nav col-12 col-lg-9">
                    <nav class="navbar navbar-expand-lg navbar-dark">
                        <div class="container-fluid content justify-content-lg-end">
                            <!-- Bot√≥n hamburguesa -->
                            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                                data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup"
                                aria-expanded="false" aria-label="Toggle navigation">
                                <span class="navbar-toggler-icon"></span>
                            </button>

                            <!-- Men√∫ -->
                            <div class="collapse navbar-collapse justify-content-lg-center" id="navbarNavAltMarkup">
                                <div class="navbar-nav text-center">
                                    <a class="nav-link active" aria-current="page" href="index.html">Inicio</a>
                                    <a class="nav-link" href="contacto.html">Contactos</a>
                                    <a class="nav-link" href="Nosotros.html">Nosotros</a>
                                    <a class="nav-link" href="servicioLinea.html">Reserva de Servicios en linea</a>
                                    <a class="nav-link" href="autor.html">Autor</a>
                                    <a class="nav-link" href="mapa.html">Mapa</a>
                                </div>
                            </div>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <!-- Secci√≥n de Contacto -->
    <main class="container contacto-container">
        <h2 class="titulo-contacto animated rubberBand">Ubicanos</h2>
        


        <!--Parte google maps-->
        <h3 class="text-center mb-4">Nuestra ubicaci√≥n: Soluciones Daniel</h3>

        <div id="map"></div>
        <div id="info" class="mt-2 text-center">Haz clic en el mapa para obtener coordenadas.</div>



        <button class="btn btn-success mt-3" onclick="getLocation()">üìç Mostrar mi ubicaci√≥n y ruta</button>
        <p id="ubicacion" class="mt-2 text-center"></p>

        <button onclick="abrirRuta()" class="btn btn-primary">
            Mostrar mi ruta
        </button>

        <p id="ubicacion"></p>


    </main>

    <footer class="footer">
        <div class="footer-container">

            <!-- Informaci√≥n de Contacto -->
            <div class="footer-info">
                <h4>Nuestra tienda</h4>
                <p><strong>üìç Ubicaci√≥n:</strong> Puntarenas, Puntarenas, Aranjuez 25 metros norte del super chino El
                    Fenix Dorado</p>
                <p><strong>üìû Tel√©fono:</strong> +506 8359-3594</p>
                <p><strong>üìß Email:</strong> solucionesdaniel@gmail.com</p>
                <p><strong>üïí Horario:</strong> Lunes - Viernes: 6 AM - 10 PM, Sabado: 3 PM - 9 PM</p>
            </div>

            <!-- Enlaces de Navegaci√≥n -->
            <div class="footer-links">
                <h4>üîó Cont√°ctanos </h4>
                <ul>
                    <li><a href="index.html">üè† Inicio</a></li>
                    <li><a href="contacto.html">üìû Contacto</a></li>
                    <li><a href="nosotros.html">‚Ñπ Nosotros</a></li>
                    <li><a href="ReservaLinea.html">üõí Reserva de Servicios en Linea</a></li>
                    <li><a href="autor.html">‚Ñπ Autor</a></li>
                </ul>
            </div>

            <!-- Redes Sociales -->
            <div class="footer-social">
                <h4>üåç S√≠guenos</h4>
                <div class="social-icons d-flex align-items-center gap-3 mt-3">
                    <a href="https://www.facebook.com" target="_blank" class="text-white fs-3">
                        <i class="bi bi-facebook"></i> <span class="ms-2 fs-5">Facebook</span>
                    </a>
                    <a href="https://www.instagram.com" target="_blank" class="text-white fs-3">
                        <i class="bi bi-instagram"></i> <span class="ms-2 fs-5">Instagram</span>
                    </a>
                    <a href="https://www.twitter.com" target="_blank" class="text-white fs-3">
                        <i class="bi bi-twitter"></i> <span class="ms-2 fs-5">Twitter</span>
                    </a>
                </div>
            </div>

        </div>

        <!-- Derechos Reservados -->
        <p class="footer-rights">¬© 2025 Soluciones Daniel - Todos los derechos reservados.</p>



        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>
    <!--<script src="js/contacto.js"></script>-->
    <script async
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA3YkZINL7ZTLdtGKcy4oHtcpZk0XslsCA&callback=iniciarMapa"></script>

<script>
        // Coordenadas de la tienda (destino)
        const tienda = { lat: 10.05937, lng: -84.79838 };


        let mapa;               // instancia de google.maps.Map
        let marcadorTienda;     // marcador de la tienda
        let marcadorUsuario;    // marcador del usuario (si existe)
        let directionsService;  // servicio de rutas
        let directionsRenderer; // renderizador de ruta

        function iniciarMapa() {
            // Crear el mapa centrado en la tienda
            mapa = new google.maps.Map(document.getElementById("map"), {
                center: tienda,
                zoom: 15,
                gestureHandling: 'greedy'
            });

            // Marcador de la tienda
            marcadorTienda = new google.maps.Marker({
                position: tienda,
                map: mapa,
                title: "Soluciones Daniel"
            });

            marcadorTienda.addListener('click', () => {
                const info = new google.maps.InfoWindow({
                    content: '<b>Soluciones Daniel</b><br>Puntarenas, Aranjuez'
                });
                info.open(mapa, marcadorTienda);
            });

            // Inicializar Directions Service/Renderer (para trazar ruta)
            directionsService = new google.maps.DirectionsService();
            directionsRenderer = new google.maps.DirectionsRenderer({
                map: mapa,
                suppressMarkers: true, // nosotros ponemos marcadores personalizados
                polylineOptions: {
                    strokeColor: '#0d6efd',
                    strokeWeight: 6,
                    strokeOpacity: 0.9
                }
            });
        }

        // Llamado por el bot√≥n: obtiene la ubicaci√≥n del usuario, muestra marcador y traza ruta
        function getLocation() {
            if (!navigator.geolocation) {
                alert("Tu navegador no soporta geolocalizaci√≥n.");
                return;
            }

            // Opcional: mostrar un indicativo de carga
            document.getElementById("ubicacion").textContent = "Obteniendo ubicaci√≥n...";

            navigator.geolocation.getCurrentPosition(async (pos) => {
                const lat = pos.coords.latitude;
                const lng = pos.coords.longitude;

                // Eliminar marcadorUsuario previo si existe
                if (marcadorUsuario) {
                    marcadorUsuario.setMap(null);
                }

                // Crear/poner marcador del usuario
                marcadorUsuario = new google.maps.Marker({
                    position: { lat, lng },
                    map: mapa,
                    title: "Tu ubicaci√≥n",
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: 8,
                        fillColor: "#00c853",
                        fillOpacity: 1,
                        strokeColor: "#ffffff",
                        strokeWeight: 2
                    }
                });

                // Centrar (ajustar bounds para que quepa todo)
                const bounds = new google.maps.LatLngBounds();
                bounds.extend({ lat, lng });
                bounds.extend(tienda);
                mapa.fitBounds(bounds, 100);

                // Mostrar coordenadas
                document.getElementById("ubicacion").textContent =
                    `Tu ubicaci√≥n: Lat ${lat.toFixed(5)}, Lng ${lng.toFixed(5)}`;

                // Trazar la ruta usando DirectionsService
                try {
                    const request = {
                        origin: { lat, lng },
                        destination: tienda,
                        travelMode: google.maps.TravelMode.DRIVING,
                        drivingOptions: {
                            departureTime: new Date() // para tr√°fico en tiempo real si aplica
                        },
                        unitSystem: google.maps.UnitSystem.METRIC
                    };

                    directionsService.route(request, function (result, status) {
                        if (status === google.maps.DirectionsStatus.OK) {
                            directionsRenderer.setDirections(result);

                            // Opcional: crear marcadores con iconos (ej: inicio y destino)
                            // Quitar marcadores autom√°ticos (suppressMarkers true) y agregar personalizados:
                            // marcadorUsuario ya est√° puesto; crear marcador destino con icono
                            marcadorTienda.setMap(mapa); // asegurar que exista
                        } else {
                            console.error("Directions request failed:", status);
                            alert("No se pudo calcular la ruta: " + status);
                        }
                    });

                } catch (err) {
                    console.error("Error al solicitar ruta:", err);
                    alert("Ocurri√≥ un error al calcular la ruta.");
                }

            }, (err) => {
                console.error("Error geolocalizaci√≥n:", err);
                alert("No se pudo obtener la ubicaci√≥n: " + err.message);
                document.getElementById("ubicacion").textContent = "No se pudo obtener la ubicaci√≥n.";
            }, {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 0
            });
        }

        // Coordenadas de tu tienda
        const tienda2 = { lat: 10.059508, lng: -83.798258 };

        function abrirRuta() {
            // 1. Validar soporte de geolocalizaci√≥n
            if (!navigator.geolocation) {
                alert("Tu navegador no soporta geolocalizaci√≥n.");
                return;
            }

            document.getElementById("ubicacion").textContent = "Obteniendo ubicaci√≥n...";

            // 2. Obtener ubicaci√≥n del usuario
            navigator.geolocation.getCurrentPosition((pos) => {

                const lat = pos.coords.latitude;
                const lng = pos.coords.longitude;

                // Mostrar las coordenadas
                document.getElementById("ubicacion").textContent =
                    `Tu ubicaci√≥n: Lat ${lat.toFixed(5)}, Lng ${lng.toFixed(5)}`;

                // 3. Construir URL de Google Maps para abrir la ruta
                const url = `https://www.google.com/maps/dir/${lat},${lng}/${tienda.lat},${tienda.lng}`;

                // 4. Abrir Google Maps en nueva pesta√±a con la ruta creada
                window.open(url, "_blank");

            }, (err) => {
                // Manejo de errores
                console.error("Error al obtener ubicaci√≥n:", err);
                alert("No se pudo obtener la ubicaci√≥n: " + err.message);
                document.getElementById("ubicacion").textContent =
                    "No se pudo obtener la ubicaci√≥n.";
            }, {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 0
            });
        }
    </script>
</body>

</html>